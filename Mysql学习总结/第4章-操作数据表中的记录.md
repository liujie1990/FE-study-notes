### 三种向数据表中插入数据的方法
**第一种:**

```
insert tb_name [column_name]values(...)[,(...),(...)];
```
比较常用，可以一次性插入多条记录，并且可以输入表达式甚至是函数，但是无法进行子查询。

**第二种：**

```
insert tb_name set column_name={exprdefault};
```
可以进行子查询，但是只能插入一条记录的多个字段,但一次只能插入一条记录(INSERT [INTO] 表名 SET 列名1=列值1, 列名2=列值2,...;)。

**第三种：**

```
insert table_name [(colname...)] select语句...
```
这种方法就是把查询到的一个表结果插入到另一个指定数据表中。
### 方法1. INSERT(插入记录)

首先创建一张数据表：

```
CREATE TABLE users(
    -> id SMALLINT UNSIGNED PRIMARY KEY AUTO_INCREMENT,
    -> username VARCHAR(20) NOT NULL,
    -> password VARCHAR(32) NOT NULL,
    -> age TINYINT UNSIGNED NOT NULL DEFAULT 10,
    -> sex BOOLEAN
    -> );
```
插入两条数据：

```
INSERT users VALUES(NULL,'Tom','123',25,1);
INSERT users VALUES(NULL,'Jerry','123',24,0);
```
查看当前数据表中的数据：

```
SELECT * FROM users;
```
当前数据表的数据如下所示，数据表的`id`字段是自动增长的，可以通过给其赋值为`NULL`或者`DEFAULT`来实现该字段的自动增长。

```
+----+----------+----------+-----+------+
| id | username | password | age | sex  |
+----+----------+----------+-----+------+
|  1 | Tom      | 123      |  25 |    1 |
|  2 | Jerry    | 123      |  24 |    0 |
|  3 | LISI     | 12345    |  24 |    0 |
+----+----------+----------+-----+------+
```

#### 1.2 查看当前表的列信息

```
SHOW COLUMNS FROM users;
```
具体信息如下：

```
+----------+----------------------+------+-----+---------+----------------+
| Field    | Type                 | Null | Key | Default | Extra          |
+----------+----------------------+------+-----+---------+----------------+
| id       | smallint(5) unsigned | NO   | PRI | NULL    | auto_increment |
| username | varchar(20)          | NO   |     | NULL    |                |
| password | varchar(32)          | NO   |     | NULL    |                |
| age      | tinyint(3) unsigned  | NO   |     | 10      |                |
| sex      | tinyint(1)           | YES  |     | NULL    |                |
+----------+----------------------+------+-----+---------+----------------+
```
#### 1.3 同时向数据表插入多条记录
```
INSERT users VALUES(DEFAULT,'LISIsi','12345',24,0),(DEFAULT,'wangwu',md5('12345'),24,1);
```
不同记录之间以逗号`,`分隔，密码字段可以通过`php`中的`md5`加密函数来进行加密操作。
### 方法2
该方法与方法1的区别在于：方法2可以使用**子查询**。

```
INSERT users SET username='Rose',password='333';
```
因为`age`字段有默认值，`sex`字段可以为空，因此这里可以只给`username`和`password`字段赋值。

### 更改数据表中的字段值(UPDATE语句)
```
UPDATE [LOW_PRIORITY] [IGNORE] table_reference SET col_name1={exp1|DEFAULT}[,col_name2=...][WHERE where_condition] 
```
```
# 多个字段之间用逗号分隔
update <表名> set <列名>=<表达式>,<列名>=<表达式>... [where <条件>];
```
#### 更新记录(单表更新)
```
# 更新前的数据表
+----+----------+----------------------------------+-----+------+
| id | username | password                         | age | sex  |
+----+----------+----------------------------------+-----+------+
|  1 | Tom      | 123                              |  25 |    1 |
|  2 | Jerry    | 123                              |  24 |    0 |
|  3 | LISI     | 12345                            |  24 |    0 |
|  4 | LISIsi   | 12345                            |  24 |    0 |
|  5 | wangwu   | 827ccb0eea8a706c4c34a16891f84e7b |  24 |    1 |
|  6 | Rose     | 333                              |  10 | NULL |
+----+----------+----------------------------------+-----+------+
```
```
# 将数据表中的所有记录的age字段增加5
UPDATE users set age = age + 5;
```
```
# 更新后的数据表
+----+----------+----------------------------------+-----+------+
| id | username | password                         | age | sex  |
+----+----------+----------------------------------+-----+------+
|  1 | Tom      | 123                              |  30 |    1 |
|  2 | Jerry    | 123                              |  29 |    0 |
|  3 | LISI     | 12345                            |  29 |    0 |
|  4 | LISIsi   | 12345                            |  29 |    0 |
|  5 | wangwu   | 827ccb0eea8a706c4c34a16891f84e7b |  29 |    1 |
|  6 | Rose     | 333                              |  15 | NULL |
+----+----------+----------------------------------+-----+------+
```
```
# 使用where增加限定条件
# 将数据表中id等于6的记录的age字段增加5
UPDATE users set age = age + 5 where id = 6;
# 将id为偶数的记录的age字段增加10
UPDATE users set age = age + 10 where id % 2 = 0;
```
#### 同时更新多个字段值
```
# 不同字段值中间以逗号分隔
UPDATE users SET age = age - id,sex=0;
```
### 删除记录(单表删除)
```
# 如果不写where条件，将删除数据表中的所有数据
# 在WHERE表达式中，可以使用MYSQL支持的函数或运算符
# 删除id为4的记录
DELETE FROM users where id = 4;
# 删除后的数据表
+----+----------+----------------------------------+-----+------+
| id | username | password                         | age | sex  |
+----+----------+----------------------------------+-----+------+
|  1 | Tom      | 123                              |  29 |    0 |
|  2 | Jerry    | 123                              |  37 |    0 |
|  3 | LISI     | 12345                            |  26 |    0 |
|  5 | wangwu   | 827ccb0eea8a706c4c34a16891f84e7b |  24 |    0 |
+----+----------+----------------------------------+-----+------+
```
```
# 新插入数据表中一条记录
INSERT users VALUES(NULL,'jack','123456',22,1);
# 插入新数据后的数据表
+----+----------+----------------------------------+-----+------+
| id | username | password                         | age | sex  |
+----+----------+----------------------------------+-----+------+
|  1 | Tom      | 123                              |  29 |    0 |
|  2 | Jerry    | 123                              |  37 |    0 |
|  3 | LISI     | 12345                            |  26 |    0 |
|  5 | wangwu   | 827ccb0eea8a706c4c34a16891f84e7b |  24 |    0 |
|  7 | jack     | 123456                           |  22 |    1 |
+----+----------+----------------------------------+-----+------+
```
**特别注意：删除id为4的记录,当把某记录删掉以后，后续增加记录即使ID号不连续，那么它新增加的记录ID为已有最大的ID号加1,面例子中新插入的记录的id为7。**
### 查找记录(SELECT)
```
SELECT VERSION();
# 结果
| VERSION() |
+-----------+
| 5.7.19    |
+-----------+

SELECT NOW();
# 结果
+---------------------+
| NOW()               |
+---------------------+
| 2017-12-23 16:23:27 |
+---------------------+
```
#### 查询表达式
1. 每一个表达式表示想要的一列，必须至少有一个；
2. 多个列之间以英文逗号分隔；
3. 星号`(*)`表示所有列，tabel_name.*可以表示当前数据表的所有列；
4. 查询表达式可以使用[As] alias_name为其赋予别名
5. 别名可用于GROUP BY，ORDRE BY或HAVING子句

**特别注意：SELECT字段出现顺序影响结果集出现顺序，字段别名也影响结果集字段别名。**

相关例子如下：

```
SELECT id AS userId,username AS uname FROM users;
# 查找结果
+--------+--------+
| userId | uname  |
+--------+--------+
|      1 | Tom    |
|      2 | Jerry  |
|      3 | LISI   |
|      5 | wangwu |
|      7 | jack   |
+--------+--------+
SELECT username AS uname,id AS userId FROM users;
# 查找结果
+--------+--------+
| uname  | userId |
+--------+--------+
| Tom    |      1 |
| Jerry  |      2 |
| LISI   |      3 |
| wangwu |      5 |
| jack   |      7 |
+--------+--------+
```
#### 查询结果分组(GROUP BY,对所有记录做分组)
```
# 当前数据表
SELECT * FROM users;
+----+----------+----------------------------------+-----+------+
| id | username | password                         | age | sex  |
+----+----------+----------------------------------+-----+------+
|  1 | Tom      | 123                              |  29 |    0 |
|  2 | Jerry    | 123                              |  37 |    0 |
|  3 | LISI     | 12345                            |  26 |    0 |
|  5 | wangwu   | 827ccb0eea8a706c4c34a16891f84e7b |  24 |    0 |
|  7 | jack     | 123456                           |  22 |    1 |
+----+----------+----------------------------------+-----+------+

SELECT sex FROM users GROUP BY sex;
# 分组结果
+------+
| sex  |
+------+
|    0 |
|    1 |
+------+
```
#### 分组条件(HAVING,对部分记录做分组)
having 语句分组，用在group by后面追加条件，判断式中的字段是必须出现在前面select中的或者是可以包含没有出现在前面查询中的字段的一个聚合函数count()，max()等等。

```
# 数据表
+----+----------+----------------------------------+-----+------+
| id | username | password                         | age | sex  |
+----+----------+----------------------------------+-----+------+
|  1 | Tom      | 123                              |  29 |    0 |
|  2 | Jerry    | 123                              |  37 |    0 |
|  3 | LISI     | 12345                            |  26 |    0 |
|  5 | wangwu   | 827ccb0eea8a706c4c34a16891f84e7b |  24 |    0 |
|  7 | jack     | 123456                           |  22 |    1 |
+----+----------+----------------------------------+-----+------+
SELECT sex FROM users GROUP BY sex HAVING count(id) >= 2;
# 显示结果
+------+
| sex  |
+------+
|    0 |
+------+
SELECT sex FROM users GROUP BY sex HAVING count(id) >= 1;
# 显示结果
+------+
| sex  |
+------+
|    0 |
|    1 |
+------+
```
上述指令是指按照sex分组，分成了两组sex=0和sex=1，条件是id数大于2的留下显示，显然sex=0个数有4条记录，大于2故留下显示，而sex=1的记录条数为1，不满足条件，故不显示。如果条件改成count(id)>=1,则会显示sex为0和1两个分组。
#### 对查询结果进行排序(ORDER BY)
```
# 按照id降序排列(DESC表示降序，ASC表示升序)
SELECT * FROM users ORDER BY id DESC;
# 结果显示如下(按照id降序排列)
+----+----------+----------------------------------+-----+------+
| id | username | password                         | age | sex  |
+----+----------+----------------------------------+-----+------+
|  8 | Rose     | 123                              |  22 |    0 |
|  7 | jack     | 123456                           |  22 |    1 |
|  5 | wangwu   | 827ccb0eea8a706c4c34a16891f84e7b |  24 |    0 |
|  3 | LISI     | 12345                            |  26 |    0 |
|  2 | Jerry    | 123                              |  37 |    0 |
|  1 | Tom      | 123                              |  29 |    0 |
+----+----------+----------------------------------+-----+------+
```
```
SELECT * FROM users ORDER BY age;(按照age排序，默认是升序)
+----+----------+----------------------------------+-----+------+
| id | username | password                         | age | sex  |
+----+----------+----------------------------------+-----+------+
|  7 | jack     | 123456                           |  22 |    1 |
|  8 | Rose     | 123                              |  22 |    0 |
|  5 | wangwu   | 827ccb0eea8a706c4c34a16891f84e7b |  24 |    0 |
|  3 | LISI     | 12345                            |  26 |    0 |
|  1 | Tom      | 123                              |  29 |    0 |
|  2 | Jerry    | 123                              |  37 |    0 |
+----+----------+----------------------------------+-----+------+
# 根据两个字段同时排序
SELECT * FROM users ORDER BY age,id DESC;
#先按照age升序排列记录，对于age相同的记录再按照id进行降序排列
+----+----------+----------------------------------+-----+------+
| id | username | password                         | age | sex  |
+----+----------+----------------------------------+-----+------+
|  8 | Rose     | 123                              |  22 |    0 |
|  7 | jack     | 123456                           |  22 |    1 |
|  5 | wangwu   | 827ccb0eea8a706c4c34a16891f84e7b |  24 |    0 |
|  3 | LISI     | 12345                            |  26 |    0 |
|  1 | Tom      | 123                              |  29 |    0 |
|  2 | Jerry    | 123                              |  37 |    0 |
+----+----------+----------------------------------+-----+------+
```
#### 限制查询结果返回的数量(LIMIT)
限制结果返回：

```
[limit {[offset,] row_count | row_count oddset }];
```
数据表的记录编号是从0开始进行编号的。

* offset：偏移量 从0开始
* row_count：返回结果的数目

```
# 当前数据表
+----+----------+----------------------------------+-----+------+
| id | username | password                         | age | sex  |
+----+----------+----------------------------------+-----+------+
|  1 | Tom      | 123                              |  29 |    0 |
|  2 | Jerry    | 123                              |  37 |    0 |
|  3 | LISI     | 12345                            |  26 |    0 |
|  5 | wangwu   | 827ccb0eea8a706c4c34a16891f84e7b |  24 |    0 |
|  7 | jack     | 123456                           |  22 |    1 |
|  8 | Rose     | 123                              |  22 |    0 |
+----+----------+----------------------------------+-----+------+
```
```
# 表示从第一条记录开始，返回2条记录
SELECT * FROM users LIMIT 2;
+----+----------+----------+-----+------+
| id | username | password | age | sex  |
+----+----------+----------+-----+------+
|  1 | Tom      | 123      |  29 |    0 |
|  2 | Jerry    | 123      |  37 |    0 |
+----+----------+----------+-----+------+
# 返回第三条和第四条记录
# SELECT * FROM users LIMIT 2,2;
+----+----------+----------------------------------+-----+------+
| id | username | password                         | age | sex  |
+----+----------+----------------------------------+-----+------+
|  3 | LISI     | 12345                            |  26 |    0 |
|  5 | wangwu   | 827ccb0eea8a706c4c34a16891f84e7b |  24 |    0 |
+----+----------+----------------------------------+-----+------+

# 先按照id进行降序排列，再返回第三条和第四条记录
SELECT * FROM users ORDER BY id DESC LIMIT 2,2;
+----+----------+----------------------------------+-----+------+
| id | username | password                         | age | sex  |
+----+----------+----------------------------------+-----+------+
|  5 | wangwu   | 827ccb0eea8a706c4c34a16891f84e7b |  24 |    0 |
|  3 | LISI     | 12345                            |  26 |    0 |
+----+----------+----------------------------------+-----+------+
```
#### 将数据表中的记录插入另外一张数据表中
```
# 新建数据表test
CREATE TABLE test(
    -> id TINYINT UNSIGNED PRIMARY KEY AUTO_INCREMENT,
    -> username VARCHAR(20)
    -> );
```
```
# 从users数据表中查询age大于等于25的记录插入到新建数据表test中
mysql> insert test(username) select username from users where age >= 25;
Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0

# 查看test数据表中的记录
SELECT * FROM test;
+----+----------+
| id | username |
+----+----------+
|  1 | Tom      |
|  2 | Jerry    |
|  3 | LISI     |
+----+----------+
```
